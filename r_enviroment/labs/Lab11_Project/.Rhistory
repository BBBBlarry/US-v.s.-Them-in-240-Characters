x = "Predicted Life Expectancy") +
theme_minimal()
grid.arrange(plot1, plot2, nrow = 1)
library(gridExtra)
grid.arrange(plot1, plot2, nrow = 1)
grid.arrange(plot1, plot2, nrow = 1)
plot1 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy") +
title("1") +
theme_minimal()
plot1 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "t") +
theme_minimal()
plot1
plot1 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital") +
theme_minimal()
plot1
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital & Controlling for Population") +
theme_minimal()
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital & Controlling for Population",
cex = 0.5) +
theme_minimal()
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital & Controlling for Population") +
theme_minimal()
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy Controlling for Population") +
theme_minimal()
grid.arrange(plot1, plot2, nrow = 1)
plot1 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy") +
theme_minimal()
plot1
plot1 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy") +
theme_minimal()
plot1
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy Controlling for Population") +
theme_minimal()
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Exp Controlling for Population") +
theme_minimal()
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital & Controlling for Population") +
theme_minimal(plot.title = element_text(size = 18, face = "bold"))
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital & Controlling for Population") +
theme_minimal() +
theme(title = element_text(size = 12))
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital & Controlling for Population") +
theme_minimal() +
theme(plot.title = element_text(size = 12))
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital & Controlling for Population") +
theme_minimal() +
theme(plot.title = element_text(size = 7))
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt \n GPD Per Capital & Controlling for Population") +
theme_minimal() +
theme(plot.title = element_text(size = 7))
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt \nGPD Per Capital & Controlling for Population") +
theme_minimal() +
theme(plot.title = element_text(size = 7))
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt \nGPD Per Capital & Controlling for Population") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt \nGPD Per Capital & Controlling for Population") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital & \nControlling for Population") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital \n& Controlling for Population") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
grid.arrange(plot1, plot2, nrow = 1)
plot1 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot1
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital \n& Controlling for Population") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
grid.arrange(plot1, plot2, nrow = 1)
plot1 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital\n") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot1
plot2 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = outOfSample, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital \n& Controlling for Population") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
grid.arrange(plot1, plot2, nrow = 1)
model <- lm(lifeExp ~ pop + gdpPercap, data = gapminder %>% filter(year == 1977))
model <- lm(lifeExp ~ pop + gdpPercap, data = gapminder %>% filter(year == 1977))
model
populations = gapminder %>% filter(year == 1977) %% select(c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal"))
populations = gapminder %>% filter(year == 1977 && country in c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal"))
populations = gapminder %>% filter(year == 1977 && country %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal"))
pred_df <- expand.grid(gdpPercap = outOfSample, pop = mean(gapminder$pop))
pred_df
pred_df <- expand.grid(gdpPercap = outOfSample, pop = populations)
pred_df
populations = gapminder %>% filter(year == 1977 && country %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal"))$pop
pred_df <- expand.grid(gdpPercap = outOfSample, pop = populations)
pred_df
populations
populations
populations <- gapminder %>% filter(year == 1977 && country %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal"))
populations
populations
"country" %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal")
"Afghanistan" %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal")
populations <- gapminder %>% filter(year == 1977)
populations
populations <- gapminder %>% filter(country %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal"))
populations
populations <- gapminder %>% filter(year == 1977 & country %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal"))
populations
populations <- gapminder %>% filter(year == 1977 & country %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal"))$pop
populations <- gapminder %>% filter(year == 1977 & country %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal")) %>% select("pop")
pred_df <- expand.grid(gdpPercap = outOfSample, pop = populations)
populations
pred_df
populations = populations%pop
pred_df <- expand.grid(gdpPercap = outOfSample, pop = populations)
populations = populations
pred_df
populations
populations <- populations$pop
populations
pred_df <- expand.grid(gdpPercap = outOfSample, pop = populations)
pred_df
populations <- (gapminder %>% filter(year == 1977 & country %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal")))$pop
gapminder
populations <- (gapminder %>% filter(year == 1977 & country %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal")))$gdpPercap
gdpPercap_pred <- (gapminder %>% filter(year == 1977 & country %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal")))$gdpPercap
populations_pred <- c(max(gapminder$pop), min(gapminder$pop))
pred_df <- expand.grid(gdpPercap = gdpPercap_pred, pop = populations)
pred_df
pred_df
pred_df
pred_df <- expand.grid(gdpPercap = gdpPercap_pred, pop = populations_pred)
pred_df
pred <- predict(model, newdata = pred_df, interval = "confidence", level = 0.95)
pred
pred
model <- lm(lifeExp ~ pop + gdpPercap, data = gapminder %>% filter(year == 1977))
gdpPercap_pred <- (gapminder %>% filter(year == 1977 & country %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal")))$gdpPercap
populations_pred <- c(max(gapminder$pop), min(gapminder$pop))
pred_df <- expand.grid(gdpPercap = gdpPercap_pred, pop = populations_pred)
pred <- predict(model, newdata = pred_df, interval = "confidence", level = 0.95)
pred
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = populations_pred, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "GPD Per Capita ($)",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt GPD Per Capital \n& Controlling for Population") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3
populations_pred
model <- lm(lifeExp ~ pop + gdpPercap, data = gapminder %>% filter(year == 1977))
gdpPercap_pred <- (gapminder %>% filter(year == 1977 & country %in% c("Afghanistan", "Canada", "Japan", "Mexico", "Nepal")))$gdpPercap
populations_pred <- c(max(gapminder$pop), min(gapminder$pop))
pred_df <- expand.grid(gdpPercap = gdpPercap_pred, pop = populations_pred)
pred <- predict(model, newdata = pred_df, interval = "confidence", level = 0.95)
populations_pred
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = populations_pred, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3
pred_df <- expand.grid(pop = populations_pred, gdpPercap = gdpPercap_pred)
pred <- predict(model, newdata = pred_df, interval = "confidence", level = 0.95)
pred
pred_df
pred
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = populations_pred, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3
setwd("~/Desktop/CAPPP/r_enviroment/labs/Lab11_Project/")
load("R_WA_data.RData")
library(ggplot2)
library(dplyr)
pred4_df <- expand.grid(DIfemDummy = c(0, 1),
wfd_distsize = WA_data$wfd_distsize[1],
ideology = WA_data$ideology[1],
wfd_urban = WA_data$wfd_urban[1],
wfd_afam = WA_data$wfd_afam[1],
wfd_hisp = WA_data$wfd_hisp[1],
wfd_forborn = WA_data$wfd_forborn[1],
wfd_relincome = WA_data$wfd_relincome[1],
wfd_college = WA_data$wfd_college[1],
wfd_schoolage = WA_data$wfd_schoolage[1],
wfd_bcpct_const = WA_data$wfd_bcpct_const[1],
rep_pres_vote = WA_data$rep_pres_vote[1],
open_seat = WA_data$open_seat[1],
DsenRace = WA_data$DsenRace[1])
pred4 <- predict(model2, newdata = pred4_df, interval = "confidence")
pred4_df
populations_pred
pred_df
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = pred_df$pop, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = populations_pred, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = populations_pred$pop, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = populations_pred$pop, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = populations_pred$pop, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3
populations_pred
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = pred_df$pop, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
populations_pred
plot3
populations_pred
populations_pred
plot3
plot3 <- ggplot(bind_cols(populations_pred, as.data.frame(pred)),
aes(y = populations_pred, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
bind_cols(pred_df, as.data.frame(pred)
bind_cols(pred_df, as.data.frame(pred)
pred_df <- expand.grid(pop = populations_pred, gdpPercap = gdpPercap_pred)
bind_cols(pred_df, as.data.frame(pred)
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = populations_pred, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3
pred
pred <- predict(model, newdata = pred_df, interval = "confidence", level = 0.95)
bind_cols(pred_df, as.data.frame(pred)
bind_cols(pred_df, as.data.frame(pred))
ggplot$
bind_cols(pred_df, as.data.frame(pred))
ggplot$bind_cols(pred_df, as.data.frame(pred))
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = populations_pred, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = pred_df$pop, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = pred_df$pop, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital",
caption = "In 1977, while contries with larger population
tend to have a greater life expectancy, their variance is also a lot larger") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3
plot3 <- ggplot(bind_cols(pred_df, as.data.frame(pred)),
aes(y = pred_df$pop, x = fit, xmin = lwr, xmax = upr)) +
geom_point(size = 4.0) +
geom_errorbarh() +
labs(y = "Population",
x = "Predicted Life Expectancy",
title = "Predicted Life Expectancy wrt Population\n& Controlling for GPD Per Capital",
caption = "In 1977, while contries with larger population
tend to have a greater life expectancy, their variance is also a lot larger.") +
theme_minimal() +
theme(plot.title = element_text(size = 10, hjust = 0.5))
plot3
# Loading the Data
```{r}
library(gapminder)
library(ggplot2)
library(dplyr)
library(grid)
library(gridExtra)
data(gapminder)
