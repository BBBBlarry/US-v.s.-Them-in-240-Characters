library(ggplot2)
library(lindia)
library(tidyr)
library(dplyr)
democracy <- read.csv(fle = "hw4_democracy.csv", header = TRUE,
stringsAsFactors = FALSE, na.strings = ".")
democracy <- read.csv(file = "hw4_democracy.csv", header = TRUE,
stringsAsFactors = FALSE, na.strings = ".")
getwd()
setwd("~/Documents/CAPPP/r_enviroment/excercises/hw4")
democracy <- read.csv(file = "hw4_democracy.csv", header = TRUE,
stringsAsFactors = FALSE, na.strings = ".")
View(democracy)
democracy %>%
select(CIVLIB)
democracy %>%
filter(year == 1980)
democracy %>%
filter(year == 1980) %>%
select(CIVLIB)
democracy %>%
filter(YEAR == 1980) %>%
select(CIVLIB)
democracy %>%
filter(YEAR == 1980)
democracy %>%
filter(YEAR == 1980) %>%
drop.na()
drop.na
library(dplyr)
democracy %>%
filter(YEAR == 1980) %>%
drop_na()
?drop_na
democracy_1980_all <- democracy %>%
filter(YEAR == 1980)
democracy_1980 <- democracy %>%
filter(YEAR == 1980)
democracy_1980 %>% nrow()
democracy_1980_all %>% nrow()
democracy_1980 %>% nrow()
democracy_1980_all %>% nrow()
democracy_1980 <- democracy %>%
filter(YEAR == 1980) %>%
drop_na()
democracy_1980 %>% nrow()
democracy_1980 %>% nrow()
democracy_1980_all %>% nrow()
democracy_1980 %>% nrow()
#Q3
democracy_1980 %>%
ggplot(aes(x = GDPW, y = CIVLIB)) +
geom_point()
#Q3
democracy_1980 %>%
ggplot(aes(x = GDPW, y = CIVLIB)) +
geom_point() +
labs(title="The Relationship between GPD Per Worker and the Level of Civil Liberties")
#Q3
democracy_1980 %>%
ggplot(aes(x = GDPW, y = CIVLIB)) +
geom_point() +
labs(title="The Relationship between GPD Per Worker and the Level of Civil Liberties",
xlab("GDP Per Worker"))
#Q3
democracy_1980 %>%
ggplot(aes(x = GDPW, y = CIVLIB)) +
geom_point() +
labs(title="The Relationship between GPD Per Worker and the Level of Civil Liberties",
xlab = "GDP Per Worker")
#Q3
democracy_1980 %>%
ggplot(aes(x = GDPW, y = CIVLIB)) +
geom_point() +
labs(title="The Relationship between GPD Per Worker and the Level of Civil Liberties") +
xlab("GDP Per Worker")
#Q3
democracy_1980 %>%
ggplot(aes(x = GDPW, y = CIVLIB)) +
geom_point() +
labs(title="The Relationship between GPD Per Worker and the Level of Civil Liberties") +
xlab("Real GDP Per Worker ($)") +
xlab("Civil Liberty Score")
#Q3
democracy_1980 %>%
ggplot(aes(x = GDPW, y = CIVLIB)) +
geom_point() +
labs(title="The Relationship between GPD Per Worker and the Level of Civil Liberties") +
xlab("Real GDP Per Worker ($)") +
ylab("Civil Liberty Score")
#Q3
democracy_1980 %>%
ggplot(aes(x = GDPW, y = CIVLIB)) +
geom_point() +
labs(title="The Relationship between GPD Per Worker and the Level of Civil Liberties") +
xlab("Real GDP Per Worker ($)") +
ylab("Civil Liberty Score") +
theme_classic()
#Q4
lm(CIVLIB ~ GDPW + DICTATOR + BRITCOL + EDTt, data = democracy_1980)
#Q4
lm(CIVLIB ~ GDPW + DICTATOR + BRITCOL + EDT, data = democracy_1980)
#Q4
lm(CIVLIB ~ GDPW  + BRITCOL + EDT, data = democracy_1980)
#Q4
lm(CIVLIB ~ GDPW + BRITCOL + EDT, data = democracy_1980)
#Q4
civlib_lm M- lm(CIVLIB ~ GDPW + BRITCOL + EDT, data = democracy_1980)
#Q4
civlib_lm <- lm(CIVLIB ~ GDPW + BRITCOL + EDT, data = democracy_1980)
summarise(civlib_lm)
summary(civlib_lm)
#Q5
ggplot(civlib_lm) + geom_point(aes(x = .fitted, y = .resid)) +
geom_hline(yintercept = 0, color = "red")
#Q5
ggplot(civlib_lm) + geom_point(aes(x = .fitted, y = .resid)) +
geom_hline(yintercept = 0, color = "red") +
labs(title="Residual Plot of the Linear Model") +
xlab("Real GDP Per Worker ($)") +
ylab("Civil Liberty Score") +
theme_classic()
#Q5
ggplot(civlib_lm) + geom_point(aes(x = .fitted, y = .resid)) +
geom_hline(yintercept = 0, color = "red") +
labs(title="Residual Plot of the Linear Model") +
xlab("Fitted") +
ylab("Residual") +
theme_classic()
ggplot(democracy_1980, aes(x = CIVLIB)) +
geom_histogram() +
theme_minimal()
ggplot(democracy_1980, aes(x = CIVLIB)) +
geom_histogram() +
labs(title="Residual Plot of the Linear Model") +
xlab("Fitted") +
ylab("Residual") +
theme_classic()
ggplot(democracy_1980, aes(x = CIVLIB)) +
geom_histogram() +
labs(title="Residual Plot of the Linear Model") +
xlab("Count") +
ylab("Civil Liberty Score") +
theme_classic()
ggplot(democracy_1980, aes(x = CIVLIB)) +
geom_histogram() +
labs(title="Residual Plot of the Linear Model") +
xlab("Civil Liberty Score") +
ylab("Count") +
theme_classic()
democracy_1980 %>% select(c(CIVLIB, GDPW))
cor(civlib_gdpw_cor)
civlib_gdpw_cor <- democracy_1980 %>% select(c(CIVLIB, GDPW))
cor(civlib_gdpw_cor)
democracy_1980_cor <- democracy_1980 %>% select(c(GDPW, BRITCOL, EDT))
cor(civlib_gdpw_cor)
cor(democracy_1980_cor)
gg_cooksd(civlib_lm, label = TRUE, show.threshold = TRUE,
threshold = "convention", scale.factor = 0.5)
library(ggplot2)
library(lindia)
library(tidyr)
library(dplyr)
setwd("~/Documents/CAPPP/r_enviroment/excercises/hw4")
democracy <- read.csv(file = "hw4_democracy.csv", header = TRUE,
stringsAsFactors = FALSE, na.strings = ".")
# Q1
"
I select CIVLIB as my dependent variable to study.
There were 128 rows including NA rows, and 101 rows without NA rows.
"
democracy_1980_all <- democracy %>%
filter(YEAR == 1980)
democracy_1980 <- democracy %>%
filter(YEAR == 1980) %>%
drop_na()
democracy_1980_all %>% nrow()
democracy_1980 %>% nrow()
#Q3
democracy_1980 %>%
ggplot(aes(x = GDPW, y = CIVLIB)) +
geom_point() +
labs(title="The Relationship between GPD Per Worker and the Level of Civil Liberties") +
xlab("Real GDP Per Worker ($)") +
ylab("Civil Liberty Score") +
theme_classic()
#Q4
civlib_lm <- lm(CIVLIB ~ GDPW + BRITCOL + EDT, data = democracy_1980)
summary(civlib_lm)
#Q5
ggplot(civlib_lm) + geom_point(aes(x = .fitted, y = .resid)) +
geom_hline(yintercept = 0, color = "red") +
labs(title="Residual Plot of the Linear Model") +
xlab("Fitted") +
ylab("Residual") +
theme_classic()
ggplot(democracy_1980, aes(x = CIVLIB)) +
geom_histogram() +
labs(title="Residual Plot of the Linear Model") +
xlab("Civil Liberty Score") +
ylab("Count") +
theme_classic()
democracy_1980_cor <- democracy_1980 %>% select(c(GDPW, BRITCOL, EDT))
cor(democracy_1980_cor)
gg_cooksd(civlib_lm, label = TRUE, show.threshold = TRUE,
threshold = "convention", scale.factor = 0.5)
