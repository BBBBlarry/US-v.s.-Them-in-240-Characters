# Q1
library(dplyr)
library(tidyr)
library(ggplot2)
data(anscombe)
#Q2
anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_data)
#Q2
anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_data, value)
#Q2
anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_data, value, -obs)
#Q2
anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_dataset, value, -obs) %>%
spread(variable_dataset, c(variable, dataset), sep=1L)
#Q2
anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_dataset, value, -obs) %>%
spread(variable_dataset, c("variable", "dataset"), sep=1L)
#Q2
anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_dataset, value, -obs) %>%
spread(variable_dataset, c("variable", "dataset")L)
#Q2
anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_dataset, value, -obs) %>%
spread(variable_dataset, c("variable", "dataset"))
#Q2
anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_dataset, value, -obs) %>%
separate(variable_dataset, c("variable", "dataset"))
#Q2
anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_dataset, value, -obs) %>%
separate(variable_dataset, c("variable", "dataset"), sep=1L)
#Q2
anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_dataset, value, -obs) %>%
separate(variable_dataset, c("variable", "dataset"), sep=1L) %>%
spread(variables, value)
#Q2
anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_dataset, value, -obs) %>%
separate(variable_dataset, c("variable", "dataset"), sep=1L) %>%
spread(variable, value)
#Q2
anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_dataset, value, -obs) %>%
separate(variable_dataset, c("variable", "dataset"), sep=1L) %>%
spread(variable, value) %>%
arrange(dataset, obs)
#Q2
anscombe2 <- anscombe %>%
mutate(obs = row_number()) %>%
gather(variable_dataset, value, -obs) %>%
separate(variable_dataset, c("variable", "dataset"), sep=1L) %>%
spread(variable, value) %>%
arrange(dataset, obs)
anscombe2 %>%
group_by(dataset) %>%
summarise(mean_x = mean(x), mean_y = mean(y))
anscombe2 %>%
group_by(dataset) %>%
summarise(mean_x = mean(x), mean_y = mean(y))
anscombe2 %>%
group_by(dataset) %>%
summarise(mean_x = mean(x), mean_y = mean(y), std_x = sd(x))
anscombe2 %>%
group_by(dataset) %>%
summarise(mean_x = mean(x), mean_y = mean(y), std_x = sd(x), std_y = sd(y))
# Q3.2
anscombe2 %>%
group_by(dataset) %>%
cor.test(x, y)
# Q3.2
anscombe2 %>%
group_by(dataset) %>%
cor.test()
# Q3.2
anscombe2 %>%
group_by(dataset)
# Q3.2
anscombe2 %>%
group_by(dataset) %>%
cor.test(x, y)
cor.test(grouped$x, grouped$yy)
cor.test(grouped$x, grouped$y)
# Q3.2
grouped <- anscombe2 %>% group_by(dataset)
cor.test(grouped$x, grouped$y)
# Q3.2
anscombe2 %>%
group_by(dataset) %>%
cor(x, y)
# Q3.2
anscombe2 %>%
group_by(dataset) %>%
cor(x, y)
# Q3.2
anscombe2 %>%
group_by(dataset) %>%
summarise(cor(x, y))
# Q3.2
anscombe2 %>%
group_by(dataset) %>%
summarise(correlation = cor(x, y))
# Q3.3
lm(y ~ x, data = anscombe2)
# Q3.3
lm(y ~ x, data = anscombe2 %>% filter(dataset = 1))
# Q3.3
lm(y ~ x, data = anscombe2 %>% filter(dataset == 1))
lm(y ~ x, data = anscombe2 %>% filter(dataset == 4))
lm(y ~ x, data = anscombe2 %>% filter(dataset == 1))
lm(y ~ x, data = anscombe2 %>% filter(dataset == 2))
lm(y ~ x, data = anscombe2 %>% filter(dataset == 3))
lm(y ~ x, data = anscombe2 %>% filter(dataset == 4))
anscombe2 %>% filter(dataset == 1)
lm(y ~ x, data = anscombe2 %>% filter(dataset == 4))
# Q3.3
summary(lm(y ~ x, data = anscombe2 %>% filter(dataset == 1)))
# Q3.3
# dataset 1: coef = 0.5001, p =
summary(lm(y ~ x, data = anscombe2 %>% filter(dataset == 1)))$
summary(lm(y ~ x, data = anscombe2 %>% filter(dataset == 2)))
# Q3.3
# dataset 1: coef = 0.5001, p =
summary(lm(y ~ x, data = anscombe2 %>% filter(dataset == 1)))
# dataset 2: coef = 0.5001, p = 0.00217
summary(lm(y ~ x, data = anscombe2 %>% filter(dataset == 2)))
# dataset 3:
summary(lm(y ~ x, data = anscombe2 %>% filter(dataset == 3)))
summary(lm(y ~ x, data = anscombe2 %>% filter(dataset == 4)))
anscombe2 %>%
filter(dataset == 1) %>%
ggplot()
anscombe2 %>%
filter(dataset == 1) %>%
ggplot(x, y)
anscombe2 %>%
filter(dataset == 1) %>%
ggplot(aes(x = x, y = y)) +
geom_point()
anscombe2 %>%
filter(dataset == 1) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm)
anscombe2 %>%
filter(dataset == 2) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm)
anscombe2 %>%
filter(dataset == 1) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
lab(title = "Anscombe Dataset 1 x-y relationship")
anscombe2 %>%
filter(dataset == 1) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
lab(title = "Anscombe Dataset 1 x-y relationship")
anscombe2 %>%
filter(dataset == 1) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 1 x-y relationship")
anscombe2 %>%
filter(dataset == 3) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 3 x-y relationship")
anscombe2 %>%
filter(dataset == 4) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 4 x-y relationship")
anscombe2 %>%
filter(dataset == 1) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 1 x-y relationship") +
theme(plot.title = element_text(hjust = 0.5))
anscombe2 %>%
filter(dataset == 1) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 1 x-y relationship") +
theme(plot.title = element_text(hjust = 0.5)) +
theme_minimal()
anscombe2 %>%
filter(dataset == 1) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 1 x-y relationship") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
anscombe2 %>%
filter(dataset == 2) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 2 x-y relationship") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
anscombe2 %>%
filter(dataset == 3) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 3 x-y relationship") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
anscombe2 %>%
filter(dataset == 4) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 4 x-y relationship") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
anscombe2
# Q1
library(dplyr)
library(tidyr)
library(ggplot2)
data(anscombe)
#Q2
anscombe2 <- anscombe %>%
# we need to keep the obervation number
mutate(obs = row_number()) %>%
# make a thin tabe to keep track of (obs, variable name + dataset name, value) mapping
gather(variable_dataset, value, -obs) %>%
# split variable name + dataset name into two columns
separate(variable_dataset, c("variable", "dataset"), sep=1L) %>%
# remap to (obs, dataset name, x value, y vcalue)
spread(variable, value) %>%
# sort by dataset name then the obervation number
arrange(dataset, obs)
# Q3.1
anscombe2 %>%
group_by(dataset) %>%
summarise(mean_x = mean(x), mean_y = mean(y), std_x = sd(x), std_y = sd(y))
# Q3.2
anscombe2 %>%
group_by(dataset) %>%
summarise(correlation = cor(x, y))
# Q3.3
# dataset 1: coef = 0.5001, p = 0.00217
summary(lm(y ~ x, data = anscombe2 %>% filter(dataset == 1)))
# dataset 2: coef = 0.5001, p = 0.00218
summary(lm(y ~ x, data = anscombe2 %>% filter(dataset == 2)))
# dataset 3: coef = 0.4997, p = 0.00218
summary(lm(y ~ x, data = anscombe2 %>% filter(dataset == 3)))
# dataset 4: coef = 0.4999, p = 0.00216
summary(lm(y ~ x, data = anscombe2 %>% filter(dataset == 4)))
# Q3.4
"
They look very similar. The means and std devs are exactly the same while the fitted lines
have very similiar coefs and p-values.
"
anscombe2 %>%
filter(dataset == 1) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 1 x-y relationship") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
anscombe2 %>%
filter(dataset == 2) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 2 x-y relationship") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
anscombe2 %>%
filter(dataset == 3) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 3 x-y relationship") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
anscombe2 %>%
filter(dataset == 4) %>%
ggplot(aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = lm) +
labs(title = "Anscombe Dataset 4 x-y relationship") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
